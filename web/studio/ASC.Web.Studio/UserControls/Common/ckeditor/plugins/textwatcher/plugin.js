/**
 * @license Copyright (c) 2003-2021, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */
(function(){function n(n,t,i){function r(n){var t=this.callback(n);if(t){if(t.text==this.lastMatched)return;this.lastMatched=t.text;this.fire("matched",t)}else this.lastMatched&&this.unmatch()}this.editor=n;this.lastMatched=null;this.ignoreNext=!1;this.callback=t;this.ignoredKeys=[16,17,18,91,35,36,37,38,39,40,33,34];this._listeners=[];this.throttle=i||0;this._buffer=CKEDITOR.tools.throttle(this.throttle,r,this)}CKEDITOR.plugins.add("textwatcher",{});n.prototype={attach:function(){function i(){var t=n.editable();this._listeners.push(t.attachListener(t,"keyup",r,this))}function r(n){this.check(n)}function t(){this.unmatch()}var n=this.editor;return this._listeners.push(n.on("contentDom",i,this)),this._listeners.push(n.on("blur",t,this)),this._listeners.push(n.on("beforeModeUnload",t,this)),this._listeners.push(n.on("setData",t,this)),this._listeners.push(n.on("afterCommandExec",t,this)),n.editable()&&i.call(this),this},check:function(n){var t,i;if(this.ignoreNext){this.ignoreNext=!1;return}n&&n.name=="keyup"&&CKEDITOR.tools.array.indexOf(this.ignoredKeys,n.data.getKey())!=-1||(t=this.editor.getSelection(),t)&&(i=t.getRanges()[0],i)&&this._buffer.input(i)},consumeNext:function(){return this.ignoreNext=!0,this},unmatch:function(){return this.lastMatched=null,this.fire("unmatched"),this},destroy:function(){CKEDITOR.tools.array.forEach(this._listeners,function(n){n.removeListener()});this._listeners=[]}};CKEDITOR.event.implementOn(n.prototype);CKEDITOR.plugins.textWatcher=n})()